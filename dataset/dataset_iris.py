import os

import numpy as np
import math
from typing import List, Any, Tuple, Union, Type

from dataset.dataset import Dataset
from dataset.dataset_item import DatasetItem
from neat.ann.ann import Ann

import csv

dataset = [DatasetItem([0.6455696202531644, 0.7954545454545454, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.620253164556962, 0.6818181818181818, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.5949367088607594, 0.7272727272727273, 0.18840579710144928, 0.08], [1, 0, 0]),
           DatasetItem([0.5822784810126581, 0.7045454545454545, 0.21739130434782608, 0.08], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.8181818181818181, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.6835443037974683, 0.8863636363636362, 0.24637681159420288, 0.16], [1, 0, 0]),
           DatasetItem([0.5822784810126581, 0.7727272727272726, 0.20289855072463767, 0.12], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.7727272727272726, 0.21739130434782608, 0.08], [1, 0, 0]),
           DatasetItem([0.5569620253164557, 0.6590909090909091, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.620253164556962, 0.7045454545454545, 0.21739130434782608, 0.04], [1, 0, 0]),
           DatasetItem([0.6835443037974683, 0.8409090909090908, 0.21739130434782608, 0.08], [1, 0, 0]),
           DatasetItem([0.6075949367088607, 0.7727272727272726, 0.2318840579710145, 0.08], [1, 0, 0]),
           DatasetItem([0.6075949367088607, 0.6818181818181818, 0.20289855072463767, 0.04], [1, 0, 0]),
           DatasetItem([0.5443037974683543, 0.6818181818181818, 0.15942028985507248, 0.04], [1, 0, 0]),
           DatasetItem([0.7341772151898733, 0.9090909090909091, 0.17391304347826086, 0.08], [1, 0, 0]),
           DatasetItem([0.7215189873417721, 1.0, 0.21739130434782608, 0.16], [1, 0, 0]),
           DatasetItem([0.6835443037974683, 0.8863636363636362, 0.18840579710144928, 0.16], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.7954545454545454, 0.20289855072463767, 0.12], [1, 0, 0]),
           DatasetItem([0.7215189873417721, 0.8636363636363635, 0.24637681159420288, 0.12], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.8636363636363635, 0.21739130434782608, 0.12], [1, 0, 0]),
           DatasetItem([0.6835443037974683, 0.7727272727272726, 0.24637681159420288, 0.08], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.8409090909090908, 0.21739130434782608, 0.16], [1, 0, 0]),
           DatasetItem([0.5822784810126581, 0.8181818181818181, 0.14492753623188406, 0.08], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.7499999999999999, 0.24637681159420288, 0.2], [1, 0, 0]),
           DatasetItem([0.6075949367088607, 0.7727272727272726, 0.27536231884057966, 0.08], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.6818181818181818, 0.2318840579710145, 0.08], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.7727272727272726, 0.2318840579710145, 0.16], [1, 0, 0]),
           DatasetItem([0.6582278481012658, 0.7954545454545454, 0.21739130434782608, 0.08], [1, 0, 0]),
           DatasetItem([0.6582278481012658, 0.7727272727272726, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.5949367088607594, 0.7272727272727273, 0.2318840579710145, 0.08], [1, 0, 0]),
           DatasetItem([0.6075949367088607, 0.7045454545454545, 0.2318840579710145, 0.08], [1, 0, 0]),
           DatasetItem([0.6835443037974683, 0.7727272727272726, 0.21739130434782608, 0.16], [1, 0, 0]),
           DatasetItem([0.6582278481012658, 0.9318181818181817, 0.21739130434782608, 0.04], [1, 0, 0]),
           DatasetItem([0.6962025316455696, 0.9545454545454545, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.620253164556962, 0.7045454545454545, 0.21739130434782608, 0.04], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.7272727272727273, 0.17391304347826086, 0.08], [1, 0, 0]),
           DatasetItem([0.6962025316455696, 0.7954545454545454, 0.18840579710144928, 0.08], [1, 0, 0]),
           DatasetItem([0.620253164556962, 0.7045454545454545, 0.21739130434782608, 0.04], [1, 0, 0]),
           DatasetItem([0.5569620253164557, 0.6818181818181818, 0.18840579710144928, 0.08], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.7727272727272726, 0.21739130434782608, 0.08], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.7954545454545454, 0.18840579710144928, 0.12], [1, 0, 0]),
           DatasetItem([0.5696202531645569, 0.5227272727272726, 0.18840579710144928, 0.12], [1, 0, 0]),
           DatasetItem([0.5569620253164557, 0.7272727272727273, 0.18840579710144928, 0.08], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.7954545454545454, 0.2318840579710145, 0.24], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.8636363636363635, 0.27536231884057966, 0.16], [1, 0, 0]),
           DatasetItem([0.6075949367088607, 0.6818181818181818, 0.20289855072463767, 0.12], [1, 0, 0]),
           DatasetItem([0.6455696202531644, 0.8636363636363635, 0.2318840579710145, 0.08], [1, 0, 0]),
           DatasetItem([0.5822784810126581, 0.7272727272727273, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.670886075949367, 0.8409090909090908, 0.21739130434782608, 0.08], [1, 0, 0]),
           DatasetItem([0.6329113924050632, 0.7499999999999999, 0.20289855072463767, 0.08], [1, 0, 0]),
           DatasetItem([0.8860759493670886, 0.7272727272727273, 0.6811594202898551, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.810126582278481, 0.7272727272727273, 0.6521739130434783, 0.6], [0, 1, 0]),
           DatasetItem([0.8734177215189873, 0.7045454545454545, 0.7101449275362319, 0.6], [0, 1, 0]),
           DatasetItem([0.6962025316455696, 0.5227272727272726, 0.5797101449275363, 0.52], [0, 1, 0]),
           DatasetItem([0.8227848101265822, 0.6363636363636362, 0.6666666666666666, 0.6], [0, 1, 0]),
           DatasetItem([0.7215189873417721, 0.6363636363636362, 0.6521739130434783, 0.52], [0, 1, 0]),
           DatasetItem([0.7974683544303797, 0.7499999999999999, 0.6811594202898551, 0.64], [0, 1, 0]),
           DatasetItem([0.620253164556962, 0.5454545454545454, 0.47826086956521735, 0.4], [0, 1, 0]),
           DatasetItem([0.8354430379746834, 0.6590909090909091, 0.6666666666666666, 0.52], [0, 1, 0]),
           DatasetItem([0.6582278481012658, 0.6136363636363636, 0.5652173913043478, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.6329113924050632, 0.45454545454545453, 0.5072463768115941, 0.4], [0, 1, 0]),
           DatasetItem([0.7468354430379747, 0.6818181818181818, 0.6086956521739131, 0.6], [0, 1, 0]),
           DatasetItem([0.7594936708860759, 0.5, 0.5797101449275363, 0.4], [0, 1, 0]),
           DatasetItem([0.7721518987341771, 0.6590909090909091, 0.6811594202898551, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.7088607594936708, 0.6590909090909091, 0.5217391304347826, 0.52], [0, 1, 0]),
           DatasetItem([0.8481012658227848, 0.7045454545454545, 0.6376811594202899, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.7088607594936708, 0.6818181818181818, 0.6521739130434783, 0.6], [0, 1, 0]),
           DatasetItem([0.7341772151898733, 0.6136363636363636, 0.5942028985507245, 0.4], [0, 1, 0]),
           DatasetItem([0.7848101265822784, 0.5, 0.6521739130434783, 0.6], [0, 1, 0]),
           DatasetItem([0.7088607594936708, 0.5681818181818181, 0.5652173913043478, 0.44000000000000006], [0, 1, 0]),
           DatasetItem([0.7468354430379747, 0.7272727272727273, 0.6956521739130435, 0.72], [0, 1, 0]),
           DatasetItem([0.7721518987341771, 0.6363636363636362, 0.5797101449275363, 0.52], [0, 1, 0]),
           DatasetItem([0.7974683544303797, 0.5681818181818181, 0.7101449275362319, 0.6], [0, 1, 0]),
           DatasetItem([0.7721518987341771, 0.6363636363636362, 0.6811594202898551, 0.48], [0, 1, 0]),
           DatasetItem([0.810126582278481, 0.6590909090909091, 0.6231884057971014, 0.52], [0, 1, 0]),
           DatasetItem([0.8354430379746834, 0.6818181818181818, 0.6376811594202899, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.860759493670886, 0.6363636363636362, 0.6956521739130435, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.8481012658227848, 0.6818181818181818, 0.7246376811594203, 0.6799999999999999], [0, 1, 0]),
           DatasetItem([0.7594936708860759, 0.6590909090909091, 0.6521739130434783, 0.6], [0, 1, 0]),
           DatasetItem([0.7215189873417721, 0.5909090909090908, 0.5072463768115941, 0.4], [0, 1, 0]),
           DatasetItem([0.6962025316455696, 0.5454545454545454, 0.5507246376811593, 0.44000000000000006], [0, 1, 0]),
           DatasetItem([0.6962025316455696, 0.5454545454545454, 0.5362318840579711, 0.4], [0, 1, 0]),
           DatasetItem([0.7341772151898733, 0.6136363636363636, 0.5652173913043478, 0.48], [0, 1, 0]),
           DatasetItem([0.7594936708860759, 0.6136363636363636, 0.7391304347826086, 0.64], [0, 1, 0]),
           DatasetItem([0.6835443037974683, 0.6818181818181818, 0.6521739130434783, 0.6], [0, 1, 0]),
           DatasetItem([0.7594936708860759, 0.7727272727272726, 0.6521739130434783, 0.64], [0, 1, 0]),
           DatasetItem([0.8481012658227848, 0.7045454545454545, 0.6811594202898551, 0.6], [0, 1, 0]),
           DatasetItem([0.7974683544303797, 0.5227272727272726, 0.6376811594202899, 0.52], [0, 1, 0]),
           DatasetItem([0.7088607594936708, 0.6818181818181818, 0.5942028985507245, 0.52], [0, 1, 0]),
           DatasetItem([0.6962025316455696, 0.5681818181818181, 0.5797101449275363, 0.52], [0, 1, 0]),
           DatasetItem([0.6962025316455696, 0.5909090909090908, 0.6376811594202899, 0.48], [0, 1, 0]),
           DatasetItem([0.7721518987341771, 0.6818181818181818, 0.6666666666666666, 0.5599999999999999], [0, 1, 0]),
           DatasetItem([0.7341772151898733, 0.5909090909090908, 0.5797101449275363, 0.48], [0, 1, 0]),
           DatasetItem([0.6329113924050632, 0.5227272727272726, 0.47826086956521735, 0.4], [0, 1, 0]),
           DatasetItem([0.7088607594936708, 0.6136363636363636, 0.6086956521739131, 0.52], [0, 1, 0]),
           DatasetItem([0.7215189873417721, 0.6818181818181818, 0.6086956521739131, 0.48], [0, 1, 0]),
           DatasetItem([0.7215189873417721, 0.6590909090909091, 0.6086956521739131, 0.52], [0, 1, 0]),
           DatasetItem([0.7848101265822784, 0.6590909090909091, 0.6231884057971014, 0.52], [0, 1, 0]),
           DatasetItem([0.6455696202531644, 0.5681818181818181, 0.43478260869565216, 0.44000000000000006], [0, 1, 0]),
           DatasetItem([0.7215189873417721, 0.6363636363636362, 0.5942028985507245, 0.52], [0, 1, 0]),
           DatasetItem([0.7974683544303797, 0.7499999999999999, 0.8695652173913043, 1.0], [0, 0, 1]),
           DatasetItem([0.7341772151898733, 0.6136363636363636, 0.7391304347826086, 0.76], [0, 0, 1]),
           DatasetItem([0.8987341772151898, 0.6818181818181818, 0.855072463768116, 0.8400000000000001], [0, 0, 1]),
           DatasetItem([0.7974683544303797, 0.6590909090909091, 0.8115942028985507, 0.72], [0, 0, 1]),
           DatasetItem([0.8227848101265822, 0.6818181818181818, 0.8405797101449275, 0.8800000000000001], [0, 0, 1]),
           DatasetItem([0.9620253164556961, 0.6818181818181818, 0.9565217391304347, 0.8400000000000001], [0, 0, 1]),
           DatasetItem([0.620253164556962, 0.5681818181818181, 0.6521739130434783, 0.6799999999999999], [0, 0, 1]),
           DatasetItem([0.9240506329113923, 0.6590909090909091, 0.9130434782608695, 0.72], [0, 0, 1]),
           DatasetItem([0.8481012658227848, 0.5681818181818181, 0.8405797101449275, 0.72], [0, 0, 1]),
           DatasetItem([0.9113924050632911, 0.8181818181818181, 0.8840579710144927, 1.0], [0, 0, 1]),
           DatasetItem([0.8227848101265822, 0.7272727272727273, 0.7391304347826086, 0.8], [0, 0, 1]),
           DatasetItem([0.810126582278481, 0.6136363636363636, 0.7681159420289855, 0.76], [0, 0, 1]),
           DatasetItem([0.860759493670886, 0.6818181818181818, 0.7971014492753623, 0.8400000000000001], [0, 0, 1]),
           DatasetItem([0.7215189873417721, 0.5681818181818181, 0.7246376811594203, 0.8], [0, 0, 1]),
           DatasetItem([0.7341772151898733, 0.6363636363636362, 0.7391304347826086, 0.96], [0, 0, 1]),
           DatasetItem([0.810126582278481, 0.7272727272727273, 0.7681159420289855, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.8227848101265822, 0.6818181818181818, 0.7971014492753623, 0.72], [0, 0, 1]),
           DatasetItem([0.9746835443037974, 0.8636363636363635, 0.9710144927536232, 0.8800000000000001], [0, 0, 1]),
           DatasetItem([0.9746835443037974, 0.5909090909090908, 1.0, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.7594936708860759, 0.5, 0.7246376811594203, 0.6], [0, 0, 1]),
           DatasetItem([0.8734177215189873, 0.7272727272727273, 0.8260869565217391, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.7088607594936708, 0.6363636363636362, 0.7101449275362319, 0.8], [0, 0, 1]),
           DatasetItem([0.9746835443037974, 0.6363636363636362, 0.9710144927536232, 0.8], [0, 0, 1]),
           DatasetItem([0.7974683544303797, 0.6136363636363636, 0.7101449275362319, 0.72], [0, 0, 1]),
           DatasetItem([0.8481012658227848, 0.7499999999999999, 0.8260869565217391, 0.8400000000000001], [0, 0, 1]),
           DatasetItem([0.9113924050632911, 0.7272727272727273, 0.8695652173913043, 0.72], [0, 0, 1]),
           DatasetItem([0.7848101265822784, 0.6363636363636362, 0.6956521739130435, 0.72], [0, 0, 1]),
           DatasetItem([0.7721518987341771, 0.6818181818181818, 0.7101449275362319, 0.72], [0, 0, 1]),
           DatasetItem([0.810126582278481, 0.6363636363636362, 0.8115942028985507, 0.8400000000000001], [0, 0, 1]),
           DatasetItem([0.9113924050632911, 0.6818181818181818, 0.8405797101449275, 0.64], [0, 0, 1]),
           DatasetItem([0.9367088607594937, 0.6363636363636362, 0.8840579710144927, 0.76], [0, 0, 1]),
           DatasetItem([1.0, 0.8636363636363635, 0.927536231884058, 0.8], [0, 0, 1]),
           DatasetItem([0.810126582278481, 0.6363636363636362, 0.8115942028985507, 0.8800000000000001], [0, 0, 1]),
           DatasetItem([0.7974683544303797, 0.6363636363636362, 0.7391304347826086, 0.6], [0, 0, 1]),
           DatasetItem([0.7721518987341771, 0.5909090909090908, 0.8115942028985507, 0.5599999999999999], [0, 0, 1]),
           DatasetItem([0.9746835443037974, 0.6818181818181818, 0.8840579710144927, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.7974683544303797, 0.7727272727272726, 0.8115942028985507, 0.96], [0, 0, 1]),
           DatasetItem([0.810126582278481, 0.7045454545454545, 0.7971014492753623, 0.72], [0, 0, 1]),
           DatasetItem([0.7594936708860759, 0.6818181818181818, 0.6956521739130435, 0.72], [0, 0, 1]),
           DatasetItem([0.8734177215189873, 0.7045454545454545, 0.782608695652174, 0.8400000000000001], [0, 0, 1]),
           DatasetItem([0.8481012658227848, 0.7045454545454545, 0.8115942028985507, 0.96], [0, 0, 1]),
           DatasetItem([0.8734177215189873, 0.7045454545454545, 0.7391304347826086, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.7341772151898733, 0.6136363636363636, 0.7391304347826086, 0.76], [0, 0, 1]),
           DatasetItem([0.860759493670886, 0.7272727272727273, 0.855072463768116, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.8481012658227848, 0.7499999999999999, 0.8260869565217391, 1.0], [0, 0, 1]),
           DatasetItem([0.8481012658227848, 0.6818181818181818, 0.7536231884057971, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.7974683544303797, 0.5681818181818181, 0.7246376811594203, 0.76], [0, 0, 1]),
           DatasetItem([0.8227848101265822, 0.6818181818181818, 0.7536231884057971, 0.8], [0, 0, 1]),
           DatasetItem([0.7848101265822784, 0.7727272727272726, 0.782608695652174, 0.9199999999999999], [0, 0, 1]),
           DatasetItem([0.7468354430379747, 0.6818181818181818, 0.7391304347826086, 0.72], [0, 0, 1])]


class DatasetIris(Dataset):

    def __init__(self, bias_nodes: int = None):
        # self.bias_nodes = 0 if bias_nodes is None else bias_nodes
        # self._dataset = []
        #
        # petal_length, petal_width, sepal_length, sepal_width, label = [], [], [], [], []
        #
        # iris = "5.1,3.5,1.4,0.2,Iris-setosa;4.9,3.0,1.4,0.2,Iris-setosa;4.7,3.2,1.3,0.2,Iris-setosa;4.6,3.1,1.5,0.2,Iris-setosa;5.0,3.6,1.4,0.2,Iris-setosa;5.4,3.9,1.7,0.4,Iris-setosa;4.6,3.4,1.4,0.3,Iris-setosa;5.0,3.4,1.5,0.2,Iris-setosa;4.4,2.9,1.4,0.2,Iris-setosa;4.9,3.1,1.5,0.1,Iris-setosa;5.4,3.7,1.5,0.2,Iris-setosa;4.8,3.4,1.6,0.2,Iris-setosa;4.8,3.0,1.4,0.1,Iris-setosa;4.3,3.0,1.1,0.1,Iris-setosa;5.8,4.0,1.2,0.2,Iris-setosa;5.7,4.4,1.5,0.4,Iris-setosa;5.4,3.9,1.3,0.4,Iris-setosa;5.1,3.5,1.4,0.3,Iris-setosa;5.7,3.8,1.7,0.3,Iris-setosa;5.1,3.8,1.5,0.3,Iris-setosa;5.4,3.4,1.7,0.2,Iris-setosa;5.1,3.7,1.5,0.4,Iris-setosa;4.6,3.6,1.0,0.2,Iris-setosa;5.1,3.3,1.7,0.5,Iris-setosa;4.8,3.4,1.9,0.2,Iris-setosa;5.0,3.0,1.6,0.2,Iris-setosa;5.0,3.4,1.6,0.4,Iris-setosa;5.2,3.5,1.5,0.2,Iris-setosa;5.2,3.4,1.4,0.2,Iris-setosa;4.7,3.2,1.6,0.2,Iris-setosa;4.8,3.1,1.6,0.2,Iris-setosa;5.4,3.4,1.5,0.4,Iris-setosa;5.2,4.1,1.5,0.1,Iris-setosa;5.5,4.2,1.4,0.2,Iris-setosa;4.9,3.1,1.5,0.1,Iris-setosa;5.0,3.2,1.2,0.2,Iris-setosa;5.5,3.5,1.3,0.2,Iris-setosa;4.9,3.1,1.5,0.1,Iris-setosa;4.4,3.0,1.3,0.2,Iris-setosa;5.1,3.4,1.5,0.2,Iris-setosa;5.0,3.5,1.3,0.3,Iris-setosa;4.5,2.3,1.3,0.3,Iris-setosa;4.4,3.2,1.3,0.2,Iris-setosa;5.0,3.5,1.6,0.6,Iris-setosa;5.1,3.8,1.9,0.4,Iris-setosa;4.8,3.0,1.4,0.3,Iris-setosa;5.1,3.8,1.6,0.2,Iris-setosa;4.6,3.2,1.4,0.2,Iris-setosa;5.3,3.7,1.5,0.2,Iris-setosa;5.0,3.3,1.4,0.2,Iris-setosa;7.0,3.2,4.7,1.4,Iris-versicolor;6.4,3.2,4.5,1.5,Iris-versicolor;6.9,3.1,4.9,1.5,Iris-versicolor;5.5,2.3,4.0,1.3,Iris-versicolor;6.5,2.8,4.6,1.5,Iris-versicolor;5.7,2.8,4.5,1.3,Iris-versicolor;6.3,3.3,4.7,1.6,Iris-versicolor;4.9,2.4,3.3,1.0,Iris-versicolor;6.6,2.9,4.6,1.3,Iris-versicolor;5.2,2.7,3.9,1.4,Iris-versicolor;5.0,2.0,3.5,1.0,Iris-versicolor;5.9,3.0,4.2,1.5,Iris-versicolor;6.0,2.2,4.0,1.0,Iris-versicolor;6.1,2.9,4.7,1.4,Iris-versicolor;5.6,2.9,3.6,1.3,Iris-versicolor;6.7,3.1,4.4,1.4,Iris-versicolor;5.6,3.0,4.5,1.5,Iris-versicolor;5.8,2.7,4.1,1.0,Iris-versicolor;6.2,2.2,4.5,1.5,Iris-versicolor;5.6,2.5,3.9,1.1,Iris-versicolor;5.9,3.2,4.8,1.8,Iris-versicolor;6.1,2.8,4.0,1.3,Iris-versicolor;6.3,2.5,4.9,1.5,Iris-versicolor;6.1,2.8,4.7,1.2,Iris-versicolor;6.4,2.9,4.3,1.3,Iris-versicolor;6.6,3.0,4.4,1.4,Iris-versicolor;6.8,2.8,4.8,1.4,Iris-versicolor;6.7,3.0,5.0,1.7,Iris-versicolor;6.0,2.9,4.5,1.5,Iris-versicolor;5.7,2.6,3.5,1.0,Iris-versicolor;5.5,2.4,3.8,1.1,Iris-versicolor;5.5,2.4,3.7,1.0,Iris-versicolor;5.8,2.7,3.9,1.2,Iris-versicolor;6.0,2.7,5.1,1.6,Iris-versicolor;5.4,3.0,4.5,1.5,Iris-versicolor;6.0,3.4,4.5,1.6,Iris-versicolor;6.7,3.1,4.7,1.5,Iris-versicolor;6.3,2.3,4.4,1.3,Iris-versicolor;5.6,3.0,4.1,1.3,Iris-versicolor;5.5,2.5,4.0,1.3,Iris-versicolor;5.5,2.6,4.4,1.2,Iris-versicolor;6.1,3.0,4.6,1.4,Iris-versicolor;5.8,2.6,4.0,1.2,Iris-versicolor;5.0,2.3,3.3,1.0,Iris-versicolor;5.6,2.7,4.2,1.3,Iris-versicolor;5.7,3.0,4.2,1.2,Iris-versicolor;5.7,2.9,4.2,1.3,Iris-versicolor;6.2,2.9,4.3,1.3,Iris-versicolor;5.1,2.5,3.0,1.1,Iris-versicolor;5.7,2.8,4.1,1.3,Iris-versicolor;6.3,3.3,6.0,2.5,Iris-virginica;5.8,2.7,5.1,1.9,Iris-virginica;7.1,3.0,5.9,2.1,Iris-virginica;6.3,2.9,5.6,1.8,Iris-virginica;6.5,3.0,5.8,2.2,Iris-virginica;7.6,3.0,6.6,2.1,Iris-virginica;4.9,2.5,4.5,1.7,Iris-virginica;7.3,2.9,6.3,1.8,Iris-virginica;6.7,2.5,5.8,1.8,Iris-virginica;7.2,3.6,6.1,2.5,Iris-virginica;6.5,3.2,5.1,2.0,Iris-virginica;6.4,2.7,5.3,1.9,Iris-virginica;6.8,3.0,5.5,2.1,Iris-virginica;5.7,2.5,5.0,2.0,Iris-virginica;5.8,2.8,5.1,2.4,Iris-virginica;6.4,3.2,5.3,2.3,Iris-virginica;6.5,3.0,5.5,1.8,Iris-virginica;7.7,3.8,6.7,2.2,Iris-virginica;7.7,2.6,6.9,2.3,Iris-virginica;6.0,2.2,5.0,1.5,Iris-virginica;6.9,3.2,5.7,2.3,Iris-virginica;5.6,2.8,4.9,2.0,Iris-virginica;7.7,2.8,6.7,2.0,Iris-virginica;6.3,2.7,4.9,1.8,Iris-virginica;6.7,3.3,5.7,2.1,Iris-virginica;7.2,3.2,6.0,1.8,Iris-virginica;6.2,2.8,4.8,1.8,Iris-virginica;6.1,3.0,4.9,1.8,Iris-virginica;6.4,2.8,5.6,2.1,Iris-virginica;7.2,3.0,5.8,1.6,Iris-virginica;7.4,2.8,6.1,1.9,Iris-virginica;7.9,3.8,6.4,2.0,Iris-virginica;6.4,2.8,5.6,2.2,Iris-virginica;6.3,2.8,5.1,1.5,Iris-virginica;6.1,2.6,5.6,1.4,Iris-virginica;7.7,3.0,6.1,2.3,Iris-virginica;6.3,3.4,5.6,2.4,Iris-virginica;6.4,3.1,5.5,1.8,Iris-virginica;6.0,3.0,4.8,1.8,Iris-virginica;6.9,3.1,5.4,2.1,Iris-virginica;6.7,3.1,5.6,2.4,Iris-virginica;6.9,3.1,5.1,2.3,Iris-virginica;5.8,2.7,5.1,1.9,Iris-virginica;6.8,3.2,5.9,2.3,Iris-virginica;6.7,3.3,5.7,2.5,Iris-virginica;6.7,3.0,5.2,2.3,Iris-virginica;6.3,2.5,5.0,1.9,Iris-virginica;6.5,3.0,5.2,2.0,Iris-virginica;6.2,3.4,5.4,2.3,Iris-virginica;5.9,3.0,5.1,1.8,Iris-virginica"
        # lines = iris.split(";")
        #
        # for row in lines:
        #     row = row.split(",")
        #     petal_length.append(float(row[0]))
        #     petal_width.append(float(row[1]))
        #     sepal_length.append(float(row[2]))
        #     sepal_width.append(float(row[3]))
        #
        #     if row[4] == "Iris-setosa":
        #         label.append([1, 0, 0])
        #     elif row[4] == "Iris-versicolor":
        #         label.append([0, 1, 0])
        #     elif row[4] == "Iris-virginica":
        #         label.append([0, 0, 1])
        #
        # for i in range(len(petal_length)):
        #     pl = petal_length[i] / max(petal_length)
        #     pw = petal_width[i] / max(petal_width)
        #     sl = sepal_length[i] / max(sepal_length)
        #     sw = sepal_width[i] / max(sepal_width)
        #
        #     self._dataset.append(DatasetItem([pl, pw, sl, sw], label[i]))
        #
        # print("[", end="")
        # for i in range(len(self._dataset)):
        #     item = self._dataset[i]
        #     print("DatasetItem(" + str(item.input) + ", " + str(item.output) + ")" + ("," if i > 0 else ""), end="")
        # print("]", end="")
        #
        # exit()

        self.bias_nodes = 0 if bias_nodes is None else bias_nodes

        self._dataset = dataset

        if self.get_bias_size() >= 1:
            for item in self._dataset:
                for _ in range(self.get_bias_size()):
                    item.input.append(1)

    def get_input_size(self) -> int:
        return 4

    def get_output_size(self) -> int:
        return 3

    def get_bias_size(self) -> int:
        return self.bias_nodes

    def get_fitness(self, ann: Ann, seed: Any = None, **kwargs) -> Tuple[float, Union[None, List[Any]], List[float], int]:
        fitness = 0
        wrong = 0

        for item in self._dataset:
            result = ann.calculate(item.input)

            fitness += sum([item.output[i] * math.log(result[i] if result[i] > 0.0000001 else 0.0000001) for i in range(self.get_output_size())])

            if item.output.index(max(item.output)) != result.index(max(result)):
                wrong += 1

        # fitness -= wrong

        fitness = len(self._dataset) - wrong
        fitness = fitness / len(self._dataset)

        return fitness, None, [fitness], 1

    def render(self, ann: Ann, seed: Any = None, **kwargs) -> str:
        counter = 0
        correct = 0

        for item in self._dataset:
            counter += 1
            result = ann.calculate(item.input)
            if item.output.index(max(item.output)) == result.index(max(result)):
                correct += 1

        result_str = "###############    IRIS RENDER: " + str(correct) + "/" + str(counter) + "    " + str(round(100 * correct / counter, 2)) + "%    #####################################"
        print("##########################################################################################")
        print(result_str)
        print("##########################################################################################")
        return result_str

    def get_seed_type(self) -> Union[None, Type[list]]:
        return None

    def get_random_seed(self, count: int) -> None:
        return None
